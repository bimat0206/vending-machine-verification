{
  "ExecuteTurn1": {
    "Type": "Task",
    "Resource": "${function_arns[\"execute_turn1\"]}",
    "Parameters": {
      "verificationContext.$": "$.verificationContext",
      "images.$": "$.images",
      "systemPrompt": {
        "systemPrompt.$": "$.systemPrompt"
      },
      "currentPrompt": {
        "currentPrompt.$": "$.currentPrompt"
      },
      "conversationState.$": "$.conversationState",
      "historicalContext": {},
      "layoutMetadata.$": "$.layoutMetadata",
      "bedrockConfig": {
        "anthropic_version.$": "$.systemPrompt.bedrockConfig.anthropic_version",
        "max_tokens.$": "$.systemPrompt.bedrockConfig.max_tokens",
        "thinking": {
          "type": "enabled",
          "budget_tokens.$": "$.systemPrompt.bedrockConfig.thinking.budget_tokens"
        }
      }
    },
    "ResultPath": "$.turn1Response",
    "Retry": [
      {
        "ErrorEquals": ["ServiceException", "ThrottlingException"],
        "IntervalSeconds": 3,
        "MaxAttempts": 5,
        "BackoffRate": 2.0
      }
    ],
    "Catch": [
      {
        "ErrorEquals": ["States.ALL"],
        "ResultPath": "$.error",
        "Next": "HandleBedrockError"
      }
    ],
    "Next": "ProcessTurn1Response"
  }
}