{
 "Description": "Verification Service Infrastructure",
 "Resources": {
  "verificationreferencebucket986F4840": {
   "Type": "AWS::S3::Bucket",
   "Properties": {
    "BucketEncryption": {
     "ServerSideEncryptionConfiguration": [
      {
       "ServerSideEncryptionByDefault": {
        "SSEAlgorithm": "AES256"
       }
      }
     ]
    },
    "BucketName": "s3-verification-reference-hwmjt8j0",
    "LifecycleConfiguration": {
     "Rules": [
      {
       "ExpirationInDays": 365,
       "Status": "Enabled",
       "Transitions": [
        {
         "StorageClass": "STANDARD_IA",
         "TransitionInDays": 30
        },
        {
         "StorageClass": "GLACIER",
         "TransitionInDays": 90
        }
       ]
      }
     ]
    },
    "PublicAccessBlockConfiguration": {
     "BlockPublicAcls": true,
     "BlockPublicPolicy": true,
     "IgnorePublicAcls": true,
     "RestrictPublicBuckets": true
    },
    "VersioningConfiguration": {
     "Status": "Enabled"
    }
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-reference-bucket/Resource"
   }
  },
  "verificationcheckingbucket3EDCD0E8": {
   "Type": "AWS::S3::Bucket",
   "Properties": {
    "BucketEncryption": {
     "ServerSideEncryptionConfiguration": [
      {
       "ServerSideEncryptionByDefault": {
        "SSEAlgorithm": "AES256"
       }
      }
     ]
    },
    "BucketName": "s3-verification-checking-hwmjt8j0",
    "LifecycleConfiguration": {
     "Rules": [
      {
       "ExpirationInDays": 365,
       "Status": "Enabled",
       "Transitions": [
        {
         "StorageClass": "STANDARD_IA",
         "TransitionInDays": 30
        },
        {
         "StorageClass": "GLACIER",
         "TransitionInDays": 90
        }
       ]
      }
     ]
    },
    "PublicAccessBlockConfiguration": {
     "BlockPublicAcls": true,
     "BlockPublicPolicy": true,
     "IgnorePublicAcls": true,
     "RestrictPublicBuckets": true
    },
    "VersioningConfiguration": {
     "Status": "Enabled"
    }
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-checking-bucket/Resource"
   }
  },
  "verificationresultsbucketD00CC3A7": {
   "Type": "AWS::S3::Bucket",
   "Properties": {
    "BucketEncryption": {
     "ServerSideEncryptionConfiguration": [
      {
       "ServerSideEncryptionByDefault": {
        "SSEAlgorithm": "AES256"
       }
      }
     ]
    },
    "BucketName": "s3-verification-results-hwmjt8j0",
    "LifecycleConfiguration": {
     "Rules": [
      {
       "ExpirationInDays": 365,
       "Status": "Enabled",
       "Transitions": [
        {
         "StorageClass": "STANDARD_IA",
         "TransitionInDays": 30
        },
        {
         "StorageClass": "GLACIER",
         "TransitionInDays": 90
        }
       ]
      }
     ]
    },
    "PublicAccessBlockConfiguration": {
     "BlockPublicAcls": true,
     "BlockPublicPolicy": true,
     "IgnorePublicAcls": true,
     "RestrictPublicBuckets": true
    },
    "VersioningConfiguration": {
     "Status": "Enabled"
    }
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-results-bucket/Resource"
   }
  },
  "verificationverificationresultstable15CDC71E": {
   "Type": "AWS::DynamoDB::Table",
   "Properties": {
    "KeySchema": [
     {
      "AttributeName": "verificationId",
      "KeyType": "HASH"
     },
     {
      "AttributeName": "verificationAt",
      "KeyType": "RANGE"
     }
    ],
    "AttributeDefinitions": [
     {
      "AttributeName": "verificationId",
      "AttributeType": "S"
     },
     {
      "AttributeName": "verificationAt",
      "AttributeType": "S"
     },
     {
      "AttributeName": "layoutId",
      "AttributeType": "N"
     },
     {
      "AttributeName": "status",
      "AttributeType": "S"
     }
    ],
    "BillingMode": "PAY_PER_REQUEST",
    "GlobalSecondaryIndexes": [
     {
      "IndexName": "GSI1",
      "KeySchema": [
       {
        "AttributeName": "layoutId",
        "KeyType": "HASH"
       },
       {
        "AttributeName": "verificationAt",
        "KeyType": "RANGE"
       }
      ],
      "Projection": {
       "ProjectionType": "ALL"
      }
     },
     {
      "IndexName": "GSI2",
      "KeySchema": [
       {
        "AttributeName": "status",
        "KeyType": "HASH"
       },
       {
        "AttributeName": "verificationAt",
        "KeyType": "RANGE"
       }
      ],
      "Projection": {
       "NonKeyAttributes": [
        "vendingMachineId",
        "layoutId",
        "resultImageUrl",
        "discrepancies"
       ],
       "ProjectionType": "INCLUDE"
      }
     }
    ],
    "PointInTimeRecoverySpecification": {
     "PointInTimeRecoveryEnabled": true
    },
    "TableName": "dynamodb-verification-verification-results-hwmjt8j0",
    "TimeToLiveSpecification": {
     "AttributeName": "expirationTime",
     "Enabled": true
    }
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-verification-results-table/Resource"
   }
  },
  "verificationlayoutmetadatatableED788ADB": {
   "Type": "AWS::DynamoDB::Table",
   "Properties": {
    "KeySchema": [
     {
      "AttributeName": "layoutId",
      "KeyType": "HASH"
     },
     {
      "AttributeName": "layoutPrefix",
      "KeyType": "RANGE"
     }
    ],
    "AttributeDefinitions": [
     {
      "AttributeName": "layoutId",
      "AttributeType": "N"
     },
     {
      "AttributeName": "layoutPrefix",
      "AttributeType": "S"
     },
     {
      "AttributeName": "createdAt",
      "AttributeType": "S"
     },
     {
      "AttributeName": "vendingMachineId",
      "AttributeType": "S"
     }
    ],
    "BillingMode": "PAY_PER_REQUEST",
    "GlobalSecondaryIndexes": [
     {
      "IndexName": "GSI1",
      "KeySchema": [
       {
        "AttributeName": "createdAt",
        "KeyType": "HASH"
       },
       {
        "AttributeName": "layoutId",
        "KeyType": "RANGE"
       }
      ],
      "Projection": {
       "ProjectionType": "KEYS_ONLY"
      }
     },
     {
      "IndexName": "GSI2",
      "KeySchema": [
       {
        "AttributeName": "vendingMachineId",
        "KeyType": "HASH"
       },
       {
        "AttributeName": "createdAt",
        "KeyType": "RANGE"
       }
      ],
      "Projection": {
       "ProjectionType": "ALL"
      }
     }
    ],
    "PointInTimeRecoverySpecification": {
     "PointInTimeRecoveryEnabled": true
    },
    "TableName": "dynamodb-verification-layout-metadata-hwmjt8j0"
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-layout-metadata-table/Resource"
   }
  },
  "verificationnotificationstopic9D1A54DA": {
   "Type": "AWS::SNS::Topic",
   "Properties": {
    "DisplayName": "Verification Service Notifications",
    "TopicName": "sns-verification-notifications-hwmjt8j0"
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-notifications-topic/Resource"
   }
  },
  "verificationvpc192E4DF3": {
   "Type": "AWS::EC2::VPC",
   "Properties": {
    "CidrBlock": "10.0.0.0/16",
    "EnableDnsHostnames": true,
    "EnableDnsSupport": true,
    "InstanceTenancy": "default",
    "Tags": [
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/Resource"
   }
  },
  "verificationvpcpublicverificationhwmjt8j0Subnet1SubnetEAC6EC2B": {
   "Type": "AWS::EC2::Subnet",
   "Properties": {
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    },
    "AvailabilityZone": "us-east-1a",
    "CidrBlock": "10.0.0.0/24",
    "MapPublicIpOnLaunch": true,
    "Tags": [
     {
      "Key": "aws-cdk:subnet-name",
      "Value": "public-verification-hwmjt8j0"
     },
     {
      "Key": "aws-cdk:subnet-type",
      "Value": "Public"
     },
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet1"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet1/Subnet"
   }
  },
  "verificationvpcpublicverificationhwmjt8j0Subnet1RouteTable8DFB9886": {
   "Type": "AWS::EC2::RouteTable",
   "Properties": {
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    },
    "Tags": [
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet1"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet1/RouteTable"
   }
  },
  "verificationvpcpublicverificationhwmjt8j0Subnet1RouteTableAssociationCE23379A": {
   "Type": "AWS::EC2::SubnetRouteTableAssociation",
   "Properties": {
    "RouteTableId": {
     "Ref": "verificationvpcpublicverificationhwmjt8j0Subnet1RouteTable8DFB9886"
    },
    "SubnetId": {
     "Ref": "verificationvpcpublicverificationhwmjt8j0Subnet1SubnetEAC6EC2B"
    }
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet1/RouteTableAssociation"
   }
  },
  "verificationvpcpublicverificationhwmjt8j0Subnet1DefaultRoute49E06D3A": {
   "Type": "AWS::EC2::Route",
   "Properties": {
    "RouteTableId": {
     "Ref": "verificationvpcpublicverificationhwmjt8j0Subnet1RouteTable8DFB9886"
    },
    "DestinationCidrBlock": "0.0.0.0/0",
    "GatewayId": {
     "Ref": "verificationvpcIGW9B4D79CE"
    }
   },
   "DependsOn": [
    "verificationvpcVPCGW98918265"
   ],
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet1/DefaultRoute"
   }
  },
  "verificationvpcpublicverificationhwmjt8j0Subnet1EIP72B602CB": {
   "Type": "AWS::EC2::EIP",
   "Properties": {
    "Domain": "vpc",
    "Tags": [
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet1"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet1/EIP"
   }
  },
  "verificationvpcpublicverificationhwmjt8j0Subnet1NATGateway7C297961": {
   "Type": "AWS::EC2::NatGateway",
   "Properties": {
    "SubnetId": {
     "Ref": "verificationvpcpublicverificationhwmjt8j0Subnet1SubnetEAC6EC2B"
    },
    "AllocationId": {
     "Fn::GetAtt": [
      "verificationvpcpublicverificationhwmjt8j0Subnet1EIP72B602CB",
      "AllocationId"
     ]
    },
    "Tags": [
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet1"
     }
    ]
   },
   "DependsOn": [
    "verificationvpcpublicverificationhwmjt8j0Subnet1DefaultRoute49E06D3A",
    "verificationvpcpublicverificationhwmjt8j0Subnet1RouteTableAssociationCE23379A"
   ],
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet1/NATGateway"
   }
  },
  "verificationvpcpublicverificationhwmjt8j0Subnet2Subnet38251022": {
   "Type": "AWS::EC2::Subnet",
   "Properties": {
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    },
    "AvailabilityZone": "us-east-1b",
    "CidrBlock": "10.0.1.0/24",
    "MapPublicIpOnLaunch": true,
    "Tags": [
     {
      "Key": "aws-cdk:subnet-name",
      "Value": "public-verification-hwmjt8j0"
     },
     {
      "Key": "aws-cdk:subnet-type",
      "Value": "Public"
     },
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet2"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet2/Subnet"
   }
  },
  "verificationvpcpublicverificationhwmjt8j0Subnet2RouteTableE89C28CD": {
   "Type": "AWS::EC2::RouteTable",
   "Properties": {
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    },
    "Tags": [
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet2"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet2/RouteTable"
   }
  },
  "verificationvpcpublicverificationhwmjt8j0Subnet2RouteTableAssociation15722825": {
   "Type": "AWS::EC2::SubnetRouteTableAssociation",
   "Properties": {
    "RouteTableId": {
     "Ref": "verificationvpcpublicverificationhwmjt8j0Subnet2RouteTableE89C28CD"
    },
    "SubnetId": {
     "Ref": "verificationvpcpublicverificationhwmjt8j0Subnet2Subnet38251022"
    }
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet2/RouteTableAssociation"
   }
  },
  "verificationvpcpublicverificationhwmjt8j0Subnet2DefaultRoute8871B42C": {
   "Type": "AWS::EC2::Route",
   "Properties": {
    "RouteTableId": {
     "Ref": "verificationvpcpublicverificationhwmjt8j0Subnet2RouteTableE89C28CD"
    },
    "DestinationCidrBlock": "0.0.0.0/0",
    "GatewayId": {
     "Ref": "verificationvpcIGW9B4D79CE"
    }
   },
   "DependsOn": [
    "verificationvpcVPCGW98918265"
   ],
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/public-verification-hwmjt8j0Subnet2/DefaultRoute"
   }
  },
  "verificationvpcprivateverificationhwmjt8j0Subnet1SubnetA0754D85": {
   "Type": "AWS::EC2::Subnet",
   "Properties": {
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    },
    "AvailabilityZone": "us-east-1a",
    "CidrBlock": "10.0.2.0/24",
    "MapPublicIpOnLaunch": false,
    "Tags": [
     {
      "Key": "aws-cdk:subnet-name",
      "Value": "private-verification-hwmjt8j0"
     },
     {
      "Key": "aws-cdk:subnet-type",
      "Value": "Private"
     },
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet1"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet1/Subnet"
   }
  },
  "verificationvpcprivateverificationhwmjt8j0Subnet1RouteTableAAD68D4C": {
   "Type": "AWS::EC2::RouteTable",
   "Properties": {
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    },
    "Tags": [
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet1"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet1/RouteTable"
   }
  },
  "verificationvpcprivateverificationhwmjt8j0Subnet1RouteTableAssociation2D963292": {
   "Type": "AWS::EC2::SubnetRouteTableAssociation",
   "Properties": {
    "RouteTableId": {
     "Ref": "verificationvpcprivateverificationhwmjt8j0Subnet1RouteTableAAD68D4C"
    },
    "SubnetId": {
     "Ref": "verificationvpcprivateverificationhwmjt8j0Subnet1SubnetA0754D85"
    }
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet1/RouteTableAssociation"
   }
  },
  "verificationvpcprivateverificationhwmjt8j0Subnet1DefaultRoute2203C41A": {
   "Type": "AWS::EC2::Route",
   "Properties": {
    "RouteTableId": {
     "Ref": "verificationvpcprivateverificationhwmjt8j0Subnet1RouteTableAAD68D4C"
    },
    "DestinationCidrBlock": "0.0.0.0/0",
    "NatGatewayId": {
     "Ref": "verificationvpcpublicverificationhwmjt8j0Subnet1NATGateway7C297961"
    }
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet1/DefaultRoute"
   }
  },
  "verificationvpcprivateverificationhwmjt8j0Subnet2Subnet25C2BCEC": {
   "Type": "AWS::EC2::Subnet",
   "Properties": {
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    },
    "AvailabilityZone": "us-east-1b",
    "CidrBlock": "10.0.3.0/24",
    "MapPublicIpOnLaunch": false,
    "Tags": [
     {
      "Key": "aws-cdk:subnet-name",
      "Value": "private-verification-hwmjt8j0"
     },
     {
      "Key": "aws-cdk:subnet-type",
      "Value": "Private"
     },
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet2"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet2/Subnet"
   }
  },
  "verificationvpcprivateverificationhwmjt8j0Subnet2RouteTableC3C5E0E8": {
   "Type": "AWS::EC2::RouteTable",
   "Properties": {
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    },
    "Tags": [
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet2"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet2/RouteTable"
   }
  },
  "verificationvpcprivateverificationhwmjt8j0Subnet2RouteTableAssociation29F60560": {
   "Type": "AWS::EC2::SubnetRouteTableAssociation",
   "Properties": {
    "RouteTableId": {
     "Ref": "verificationvpcprivateverificationhwmjt8j0Subnet2RouteTableC3C5E0E8"
    },
    "SubnetId": {
     "Ref": "verificationvpcprivateverificationhwmjt8j0Subnet2Subnet25C2BCEC"
    }
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet2/RouteTableAssociation"
   }
  },
  "verificationvpcprivateverificationhwmjt8j0Subnet2DefaultRoute3B4E2E38": {
   "Type": "AWS::EC2::Route",
   "Properties": {
    "RouteTableId": {
     "Ref": "verificationvpcprivateverificationhwmjt8j0Subnet2RouteTableC3C5E0E8"
    },
    "DestinationCidrBlock": "0.0.0.0/0",
    "NatGatewayId": {
     "Ref": "verificationvpcpublicverificationhwmjt8j0Subnet1NATGateway7C297961"
    }
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/private-verification-hwmjt8j0Subnet2/DefaultRoute"
   }
  },
  "verificationvpcIGW9B4D79CE": {
   "Type": "AWS::EC2::InternetGateway",
   "Properties": {
    "Tags": [
     {
      "Key": "Name",
      "Value": "verification-service-stack-hwmjt8j0/verification-vpc"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/IGW"
   }
  },
  "verificationvpcVPCGW98918265": {
   "Type": "AWS::EC2::VPCGatewayAttachment",
   "Properties": {
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    },
    "InternetGatewayId": {
     "Ref": "verificationvpcIGW9B4D79CE"
    }
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-vpc/VPCGW"
   }
  },
  "verificationcluster4434DF89": {
   "Type": "AWS::ECS::Cluster",
   "Properties": {
    "ClusterName": "ecs-verification-cluster-hwmjt8j0"
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-cluster/Resource"
   }
  },
  "verificationexecutionrole1FBA4289": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "ecs-tasks.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"
       ]
      ]
     }
    ],
    "RoleName": "iam-verification-execution-role-hwmjt8j0"
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-execution-role/Resource"
   }
  },
  "verificationexecutionroleDefaultPolicyEE3E85BF": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "ecr:BatchCheckLayerAvailability",
        "ecr:BatchGetImage",
        "ecr:GetDownloadUrlForLayer"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "verificationrepository2DC44251",
         "Arn"
        ]
       }
      },
      {
       "Action": "ecr:GetAuthorizationToken",
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "logs:CreateLogStream",
        "logs:PutLogEvents"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "verificationlogs85E5C620",
         "Arn"
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "verificationexecutionroleDefaultPolicyEE3E85BF",
    "Roles": [
     {
      "Ref": "verificationexecutionrole1FBA4289"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-execution-role/DefaultPolicy/Resource"
   }
  },
  "verificationtaskrole1D6B0482": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "ecs-tasks.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "RoleName": "iam-verification-task-role-hwmjt8j0"
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-task-role/Resource"
   }
  },
  "verificationtaskroleDefaultPolicy184884B5": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "s3:GetObject",
        "s3:ListBucket",
        "s3:PutObject"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "verificationcheckingbucket3EDCD0E8",
          "Arn"
         ]
        },
        {
         "Fn::GetAtt": [
          "verificationreferencebucket986F4840",
          "Arn"
         ]
        },
        {
         "Fn::GetAtt": [
          "verificationresultsbucketD00CC3A7",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "verificationcheckingbucket3EDCD0E8",
             "Arn"
            ]
           },
           "/*"
          ]
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "verificationreferencebucket986F4840",
             "Arn"
            ]
           },
           "/*"
          ]
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "verificationresultsbucketD00CC3A7",
             "Arn"
            ]
           },
           "/*"
          ]
         ]
        }
       ]
      },
      {
       "Action": [
        "dynamodb:DeleteItem",
        "dynamodb:GetItem",
        "dynamodb:PutItem",
        "dynamodb:Query",
        "dynamodb:Scan",
        "dynamodb:UpdateItem"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "verificationlayoutmetadatatableED788ADB",
          "Arn"
         ]
        },
        {
         "Fn::GetAtt": [
          "verificationverificationresultstable15CDC71E",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "verificationlayoutmetadatatableED788ADB",
             "Arn"
            ]
           },
           "/index/*"
          ]
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "verificationverificationresultstable15CDC71E",
             "Arn"
            ]
           },
           "/index/*"
          ]
         ]
        }
       ]
      },
      {
       "Action": [
        "bedrock:InvokeModel",
        "bedrock:InvokeModelWithResponseStream"
       ],
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": "sns:Publish",
       "Effect": "Allow",
       "Resource": {
        "Ref": "verificationnotificationstopic9D1A54DA"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "verificationtaskroleDefaultPolicy184884B5",
    "Roles": [
     {
      "Ref": "verificationtaskrole1D6B0482"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-task-role/DefaultPolicy/Resource"
   }
  },
  "verificationrepository2DC44251": {
   "Type": "AWS::ECR::Repository",
   "Properties": {
    "LifecyclePolicy": {
     "LifecyclePolicyText": "{\"rules\":[{\"rulePriority\":1,\"description\":\"Keep only the last 5 images\",\"selection\":{\"tagStatus\":\"any\",\"countType\":\"imageCountMoreThan\",\"countNumber\":5},\"action\":{\"type\":\"expire\"}}]}"
    },
    "RepositoryName": "ecr-verification-service-hwmjt8j0"
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-repository/Resource"
   }
  },
  "verificationlogs85E5C620": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": "/ecs/logs-verification-service-hwmjt8j0",
    "RetentionInDays": 30
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-logs/Resource"
   }
  },
  "verificationtaskdefinition616A492B": {
   "Type": "AWS::ECS::TaskDefinition",
   "Properties": {
    "ContainerDefinitions": [
     {
      "Environment": [
       {
        "Name": "SERVER_PORT",
        "Value": "3000"
       },
       {
        "Name": "SERVER_READ_TIMEOUT_SECS",
        "Value": "30"
       },
       {
        "Name": "SERVER_WRITE_TIMEOUT_SECS",
        "Value": "30"
       },
       {
        "Name": "SERVER_IDLE_TIMEOUT_SECS",
        "Value": "60"
       },
       {
        "Name": "AWS_REGION",
        "Value": "us-east-1"
       },
       {
        "Name": "DYNAMODB_VERIFICATION_TABLE",
        "Value": {
         "Ref": "verificationverificationresultstable15CDC71E"
        }
       },
       {
        "Name": "DYNAMODB_LAYOUT_TABLE",
        "Value": {
         "Ref": "verificationlayoutmetadatatableED788ADB"
        }
       },
       {
        "Name": "S3_REFERENCE_BUCKET",
        "Value": {
         "Ref": "verificationreferencebucket986F4840"
        }
       },
       {
        "Name": "S3_CHECKING_BUCKET",
        "Value": {
         "Ref": "verificationcheckingbucket3EDCD0E8"
        }
       },
       {
        "Name": "S3_RESULTS_BUCKET",
        "Value": {
         "Ref": "verificationresultsbucketD00CC3A7"
        }
       },
       {
        "Name": "BEDROCK_MODEL_ID",
        "Value": "anthropic.claude-3-7-sonnet-20250219"
       },
       {
        "Name": "BEDROCK_MAX_RETRIES",
        "Value": "3"
       },
       {
        "Name": "NOTIFICATION_SNS_TOPIC_ARN",
        "Value": {
         "Ref": "verificationnotificationstopic9D1A54DA"
        }
       },
       {
        "Name": "LOG_LEVEL",
        "Value": "INFO"
       }
      ],
      "Essential": true,
      "Image": {
       "Fn::Join": [
        "",
        [
         {
          "Fn::Select": [
           4,
           {
            "Fn::Split": [
             ":",
             {
              "Fn::GetAtt": [
               "verificationrepository2DC44251",
               "Arn"
              ]
             }
            ]
           }
          ]
         },
         ".dkr.ecr.",
         {
          "Fn::Select": [
           3,
           {
            "Fn::Split": [
             ":",
             {
              "Fn::GetAtt": [
               "verificationrepository2DC44251",
               "Arn"
              ]
             }
            ]
           }
          ]
         },
         ".",
         {
          "Ref": "AWS::URLSuffix"
         },
         "/",
         {
          "Ref": "verificationrepository2DC44251"
         },
         ":latest"
        ]
       ]
      },
      "LogConfiguration": {
       "LogDriver": "awslogs",
       "Options": {
        "awslogs-group": {
         "Ref": "verificationlogs85E5C620"
        },
        "awslogs-stream-prefix": "verification",
        "awslogs-region": "us-east-1"
       }
      },
      "Name": "container-verification-hwmjt8j0",
      "PortMappings": [
       {
        "ContainerPort": 3000,
        "Protocol": "tcp"
       }
      ]
     }
    ],
    "Cpu": "1024",
    "ExecutionRoleArn": {
     "Fn::GetAtt": [
      "verificationexecutionrole1FBA4289",
      "Arn"
     ]
    },
    "Family": "task-verification-service-hwmjt8j0",
    "Memory": "2048",
    "NetworkMode": "awsvpc",
    "RequiresCompatibilities": [
     "FARGATE"
    ],
    "TaskRoleArn": {
     "Fn::GetAtt": [
      "verificationtaskrole1D6B0482",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-task-definition/Resource"
   }
  },
  "verificationlbsg5077C890": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "Security group for verification service load balancer",
    "GroupName": "secgrp-verification-lb-hwmjt8j0",
    "SecurityGroupEgress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow all outbound traffic by default",
      "IpProtocol": "-1"
     }
    ],
    "SecurityGroupIngress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow HTTP traffic",
      "FromPort": 80,
      "IpProtocol": "tcp",
      "ToPort": 80
     },
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow HTTPS traffic",
      "FromPort": 443,
      "IpProtocol": "tcp",
      "ToPort": 443
     }
    ],
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    }
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-lb-sg/Resource"
   }
  },
  "verificationservicesg84C595FA": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "Security group for verification service",
    "GroupName": "secgrp-verification-service-hwmjt8j0",
    "SecurityGroupEgress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow all outbound traffic by default",
      "IpProtocol": "-1"
     }
    ],
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    }
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-service-sg/Resource"
   }
  },
  "verificationservicesgfromverificationservicestackhwmjt8j0verificationlbsg550D1040300039B1F3EB": {
   "Type": "AWS::EC2::SecurityGroupIngress",
   "Properties": {
    "IpProtocol": "tcp",
    "Description": "Allow traffic from ALB",
    "FromPort": 3000,
    "GroupId": {
     "Fn::GetAtt": [
      "verificationservicesg84C595FA",
      "GroupId"
     ]
    },
    "SourceSecurityGroupId": {
     "Fn::GetAtt": [
      "verificationlbsg5077C890",
      "GroupId"
     ]
    },
    "ToPort": 3000
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-service-sg/from verificationservicestackhwmjt8j0verificationlbsg550D1040:3000"
   }
  },
  "verificationalb2F01495C": {
   "Type": "AWS::ElasticLoadBalancingV2::LoadBalancer",
   "Properties": {
    "LoadBalancerAttributes": [
     {
      "Key": "deletion_protection.enabled",
      "Value": "false"
     }
    ],
    "Name": "alb-verification-hwmjt8j0",
    "Scheme": "internet-facing",
    "SecurityGroups": [
     {
      "Fn::GetAtt": [
       "verificationlbsg5077C890",
       "GroupId"
      ]
     }
    ],
    "Subnets": [
     {
      "Ref": "verificationvpcpublicverificationhwmjt8j0Subnet1SubnetEAC6EC2B"
     },
     {
      "Ref": "verificationvpcpublicverificationhwmjt8j0Subnet2Subnet38251022"
     }
    ],
    "Type": "application"
   },
   "DependsOn": [
    "verificationvpcpublicverificationhwmjt8j0Subnet1DefaultRoute49E06D3A",
    "verificationvpcpublicverificationhwmjt8j0Subnet1RouteTableAssociationCE23379A",
    "verificationvpcpublicverificationhwmjt8j0Subnet2DefaultRoute8871B42C",
    "verificationvpcpublicverificationhwmjt8j0Subnet2RouteTableAssociation15722825"
   ],
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-alb/Resource"
   }
  },
  "verificationalbverificationhttplistenerD641CAB3": {
   "Type": "AWS::ElasticLoadBalancingV2::Listener",
   "Properties": {
    "DefaultActions": [
     {
      "TargetGroupArn": {
       "Ref": "verificationtargetgroupCAEB198D"
      },
      "Type": "forward"
     }
    ],
    "LoadBalancerArn": {
     "Ref": "verificationalb2F01495C"
    },
    "Port": 80,
    "Protocol": "HTTP"
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-alb/verification-http-listener/Resource"
   }
  },
  "verificationtargetgroupCAEB198D": {
   "Type": "AWS::ElasticLoadBalancingV2::TargetGroup",
   "Properties": {
    "HealthCheckIntervalSeconds": 30,
    "HealthCheckPath": "/health",
    "HealthCheckTimeoutSeconds": 5,
    "Matcher": {
     "HttpCode": "200"
    },
    "Name": "tg-verification-hwmjt8j0",
    "Port": 3000,
    "Protocol": "HTTP",
    "TargetGroupAttributes": [
     {
      "Key": "stickiness.enabled",
      "Value": "false"
     }
    ],
    "TargetType": "ip",
    "VpcId": {
     "Ref": "verificationvpc192E4DF3"
    }
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-target-group/Resource"
   }
  },
  "verificationserviceServiceA39A59CB": {
   "Type": "AWS::ECS::Service",
   "Properties": {
    "Cluster": {
     "Ref": "verificationcluster4434DF89"
    },
    "DeploymentConfiguration": {
     "MaximumPercent": 200,
     "MinimumHealthyPercent": 50
    },
    "DesiredCount": 0,
    "EnableECSManagedTags": false,
    "HealthCheckGracePeriodSeconds": 60,
    "LaunchType": "FARGATE",
    "LoadBalancers": [
     {
      "ContainerName": "container-verification-hwmjt8j0",
      "ContainerPort": 3000,
      "TargetGroupArn": {
       "Ref": "verificationtargetgroupCAEB198D"
      }
     }
    ],
    "NetworkConfiguration": {
     "AwsvpcConfiguration": {
      "AssignPublicIp": "DISABLED",
      "SecurityGroups": [
       {
        "Fn::GetAtt": [
         "verificationservicesg84C595FA",
         "GroupId"
        ]
       }
      ],
      "Subnets": [
       {
        "Ref": "verificationvpcprivateverificationhwmjt8j0Subnet1SubnetA0754D85"
       },
       {
        "Ref": "verificationvpcprivateverificationhwmjt8j0Subnet2Subnet25C2BCEC"
       }
      ]
     }
    },
    "ServiceName": "svc-verification-hwmjt8j0",
    "TaskDefinition": {
     "Ref": "verificationtaskdefinition616A492B"
    }
   },
   "DependsOn": [
    "verificationalbverificationhttplistenerD641CAB3"
   ],
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/verification-service/Service"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/31Sy26DMBD8ltwdN00uvSZpG0WKWgRRrpVxHLIFbORHIoT49y42BNpDT56dHS8za5b0ZUEXM3Y3c37O5wWktEks4zlB6qsxK9psHM+FJduLDKgl51qyUp1RemRpIbqWBy0x0iCpKuCe7EBLBF/S5lR56hRtSeTSAnjiUhnGjihWzorHzMCP3NoYxYFZUPIh7sDbPuqOD2Z3zIo7q0mk4YZwHLyXVmjEgyA46au1xcDXUkhLEsGdBlvvtHKV9/AvsZeZFsZ0ETH3tnAGP9OpBvjOdMY6+yZ/FReQMJj/yyhpGUihJ1x/NxH6BjwsJMCWACtpE6uwJn9GClfqcwXUWdKoEZUyYJX2rbFqSaEytHxQ2SPZgPFqwYwFXih2TlnBJAeZ3fAN11WFs/0DHLC38b0Q+Fc91QHuQfaaAU/6RwyJzzJ4mJRtS2JhlNMh+6ezlQs/Sc+2JKrtVcmnFX1e0eXs2wDMtZMWSkHjcP4ADMUqbt8CAAA="
   },
   "Metadata": {
    "aws:cdk:path": "verification-service-stack-hwmjt8j0/CDKMetadata/Default"
   }
  }
 },
 "Outputs": {
  "RandomSuffix": {
   "Description": "Random suffix used for all resources",
   "Value": "hwmjt8j0"
  },
  "VerificationTableName": {
   "Description": "DynamoDB table for verification results",
   "Value": {
    "Ref": "verificationverificationresultstable15CDC71E"
   }
  },
  "LayoutTableName": {
   "Description": "DynamoDB table for layout metadata",
   "Value": {
    "Ref": "verificationlayoutmetadatatableED788ADB"
   }
  },
  "ReferenceBucketName": {
   "Description": "S3 bucket for reference images",
   "Value": {
    "Ref": "verificationreferencebucket986F4840"
   }
  },
  "CheckingBucketName": {
   "Description": "S3 bucket for checking images",
   "Value": {
    "Ref": "verificationcheckingbucket3EDCD0E8"
   }
  },
  "ResultsBucketName": {
   "Description": "S3 bucket for results",
   "Value": {
    "Ref": "verificationresultsbucketD00CC3A7"
   }
  },
  "NotificationTopicArn": {
   "Description": "SNS topic for notifications",
   "Value": {
    "Ref": "verificationnotificationstopic9D1A54DA"
   }
  },
  "ECRRepositoryUri": {
   "Description": "ECR repository for service images",
   "Value": {
    "Fn::Join": [
     "",
     [
      {
       "Fn::Select": [
        4,
        {
         "Fn::Split": [
          ":",
          {
           "Fn::GetAtt": [
            "verificationrepository2DC44251",
            "Arn"
           ]
          }
         ]
        }
       ]
      },
      ".dkr.ecr.",
      {
       "Fn::Select": [
        3,
        {
         "Fn::Split": [
          ":",
          {
           "Fn::GetAtt": [
            "verificationrepository2DC44251",
            "Arn"
           ]
          }
         ]
        }
       ]
      },
      ".",
      {
       "Ref": "AWS::URLSuffix"
      },
      "/",
      {
       "Ref": "verificationrepository2DC44251"
      }
     ]
    ]
   }
  },
  "LoadBalancerDnsName": {
   "Description": "ALB DNS name",
   "Value": {
    "Fn::GetAtt": [
     "verificationalb2F01495C",
     "DNSName"
    ]
   }
  }
 },
 "Parameters": {
  "BootstrapVersion": {
   "Type": "AWS::SSM::Parameter::Value<String>",
   "Default": "/cdk-bootstrap/hnb659fds/version",
   "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]"
  }
 },
 "Rules": {
  "CheckBootstrapVersion": {
   "Assertions": [
    {
     "Assert": {
      "Fn::Not": [
       {
        "Fn::Contains": [
         [
          "1",
          "2",
          "3",
          "4",
          "5"
         ],
         {
          "Ref": "BootstrapVersion"
         }
        ]
       }
      ]
     },
     "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI."
    }
   ]
  }
 }
}